var R=(I,f,s)=>new Promise((w,v)=>{var m=g=>{try{b(s.next(g))}catch(C){v(C)}},y=g=>{try{b(s.throw(g))}catch(C){v(C)}},b=g=>g.done?w(g.value):Promise.resolve(g.value).then(m,y);b((s=s.apply(I,f)).next())});import{_ as M,r as k,c as P,a as B,b as c,d as e,t as l,u as a,e as n,l as z,m as E,w as p,F,f as O,T as U,o as u,i,j as x,B as N,k as j,g as _,D as G}from"./index.js";const q={class:"max-w-7xl mx-auto space-y-6"},J={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4"},Q={class:"flex items-center gap-2 text-gray-500 mt-1"},Y={class:"text-sm"},H={class:"flex items-center gap-3"},K={class:"relative"},W={class:"bg-white rounded-2xl border border-gray-200 shadow-soft overflow-hidden"},X={class:"overflow-x-auto"},Z={class:"w-full text-left border-collapse"},ee={class:"divide-y divide-gray-100"},te={key:0},se={key:1},ae={colspan:"5",class:"px-6 py-16 text-center text-gray-500"},oe=["onClick"],re={class:"px-6 py-4"},ne={class:"flex items-center gap-3"},le={class:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-100 to-indigo-100 text-primary-700 flex items-center justify-center font-bold text-sm shadow-sm border border-white"},ie={class:"font-bold text-gray-900 group-hover:text-primary-600 transition-colors"},de={class:"text-xs text-gray-500 flex items-center gap-1"},ce={class:"px-6 py-4"},ue={class:"px-6 py-4"},me={class:"flex flex-col gap-1"},xe={key:0,class:"flex items-center text-sm text-gray-900"},pe={key:1,class:"flex items-center text-sm text-gray-500"},ge={key:2,class:"text-xs text-gray-400 italic"},fe={class:"px-6 py-4 text-sm text-gray-600 font-medium"},ye={class:"px-6 py-4 text-right"},he={class:"px-6 py-4 border-t border-gray-200 flex items-center justify-between bg-gray-50/50"},ve={class:"flex gap-2"},be={class:"p-1 rounded hover:bg-white hover:shadow-sm text-gray-400 hover:text-gray-600 disabled:opacity-50",disabled:""},_e={class:"p-1 rounded hover:bg-white hover:shadow-sm text-gray-400 hover:text-gray-600 disabled:opacity-50",disabled:""},we={class:"flex items-center gap-2 text-lg font-bold text-gray-900"},Ce={key:0,class:"mt-6 space-y-8"},ke={class:"flex flex-col sm:flex-row items-center sm:items-start gap-6 bg-white p-6 rounded-2xl border border-gray-100 shadow-sm relative overflow-hidden"},Ne={class:"w-24 h-24 rounded-full bg-gradient-to-br from-primary-500 to-indigo-600 flex items-center justify-center text-3xl font-bold text-white shadow-lg shadow-primary-500/30 flex-shrink-0 border-4 border-white"},je={class:"text-center sm:text-left flex-1 relative z-10"},De={class:"text-2xl font-bold text-gray-900"},Ie={class:"text-gray-500 font-medium text-lg"},Se={class:"flex flex-wrap items-center justify-center sm:justify-start gap-3 mt-3"},Ve={key:0,class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600 border border-gray-200"},$e={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Re={class:"space-y-4"},Te={class:"bg-gray-50 p-4 rounded-xl border border-gray-200 space-y-3"},Ae={class:"flex items-center gap-3"},Le={class:"p-2 bg-white rounded-lg shadow-sm text-gray-400"},Me={class:"flex-1 overflow-hidden"},Pe=["title"],Be={class:"flex items-center gap-3"},ze={class:"p-2 bg-white rounded-lg shadow-sm text-gray-400"},Ee={class:"flex-1 overflow-hidden"},Fe=["title"],Oe={class:"bg-gray-50 p-4 rounded-xl border border-gray-200 space-y-3"},Ue={class:"flex items-center gap-3"},Ge={class:"p-2 bg-white rounded-lg shadow-sm text-gray-400"},qe={class:"flex-1"},Je={class:"text-sm font-semibold text-gray-900"},Qe={class:"flex flex-col h-full"},Ye={class:"flex-1 bg-gradient-to-b from-primary-50 to-white p-6 rounded-2xl border border-primary-100 flex flex-col items-center justify-center text-center space-y-6"},He={key:0},Ke={class:"w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-lg shadow-primary-500/20 mb-4 mx-auto animate-pulse"},We={class:"text-sm text-gray-500 mt-1 mb-6 max-w-xs mx-auto"},Xe={class:"font-semibold text-gray-900"},Ze={key:1,class:"text-center py-8"},et={class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4 mx-auto"},tt={class:"flex justify-between w-full"},st={class:"text-sm font-bold text-gray-900"},at={class:"text-xs text-gray-500 mt-0.5 leading-relaxed"},ot={__name:"Contacts",setup(I){const f=k(!1),s=k(null),w=k(!1),v=k(""),m=k({show:!1,title:"",message:"",type:"success"}),y=P({url:"frappe.client.get_list",params:{doctype:"Contact",fields:["name","first_name","last_name","salutation","email_id","mobile_no","phone","status","designation","company_name","gender"],order_by:"creation desc",limit:1e3},auto:!0}),b=B(()=>{if(!y.data)return[];const o=v.value.toLowerCase();return o?y.data.filter(t=>{const d=`${t.first_name||""} ${t.last_name||""}`.toLowerCase(),r=(t.email_id||"").toLowerCase(),$=(t.mobile_no||t.phone||"").toLowerCase(),L=(t.company_name||"").toLowerCase();return d.includes(o)||r.includes(o)||$.includes(o)||L.includes(o)}):y.data});function g(){window.open("/app/contact/new","_blank")}function C(o){s.value=o,f.value=!0}function T(){s.value&&window.open(`/app/contact/${s.value.name}`,"_blank")}function D(o,t,d="success"){m.value={show:!0,title:o,message:t,type:d},setTimeout(()=>{m.value.show=!1},4e3)}function A(){return R(this,null,function*(){const o=s.value,t=h(o);if(!t){D("Missing Info","No phone number found for this contact.","error");return}w.value=!0;try{const d=yield fetch("/api/method/ai_calling_agent.api.start_ai_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone_number:`${t}`,contact_docname:o.name})}),r=yield d.json();if(d.ok)D("Call Initiated","Connecting agent...","success"),f.value=!1;else throw new Error(r.message||"Server Error")}catch(d){console.error(d),D("Error",`Failed to start call: ${d.message}`,"error")}finally{w.value=!1}})}function h(o){return o.mobile_no||o.phone||null}function S(o){return o==="Open"?"bg-green-50 text-green-700 border-green-200":o==="Replied"?"bg-blue-50 text-blue-700 border-blue-200":o==="Passive"?"bg-orange-50 text-orange-700 border-orange-200":"bg-gray-50 text-gray-600 border-gray-200"}function V(o){const t=o.first_name?o.first_name[0]:"",d=o.last_name?o.last_name[0]:"";return(t+d).toUpperCase()}return(o,t)=>{var d;return u(),c("div",q,[e("header",J,[e("div",null,[t[6]||(t[6]=e("h1",{class:"text-3xl font-bold text-gray-900 tracking-tight"},"Contacts",-1)),e("div",Q,[t[4]||(t[4]=e("span",{class:"text-sm"},"Synced with Frappe CRM",-1)),t[5]||(t[5]=e("span",{class:"w-1 h-1 bg-gray-300 rounded-full"},null,-1)),e("span",Y,l(((d=a(y).data)==null?void 0:d.length)||0)+" entries",1)])]),e("div",H,[e("div",K,[n(a(i),{name:"search",class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),z(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>v.value=r),type:"text",placeholder:"Search contacts...",class:"pl-9 pr-4 py-2 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 w-full sm:w-64 transition-shadow"},null,512),[[E,v.value]])]),n(a(N),{variant:"solid",class:"!bg-primary-600 hover:!bg-primary-700 !text-white !border-transparent !rounded-xl shadow-md shadow-primary-500/20",onClick:g},{prefix:p(()=>[n(a(i),{name:"plus",class:"h-4 w-4"})]),default:p(()=>[t[7]||(t[7]=x(" Add Contact ",-1))]),_:1})])]),e("div",W,[e("div",X,[e("table",Z,[t[11]||(t[11]=e("thead",null,[e("tr",{class:"bg-gray-50/50 border-b border-gray-200"},[e("th",{class:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Name & Designation"),e("th",{class:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Contact Info"),e("th",{class:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Company"),e("th",{class:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider text-right"},"Action")])],-1)),e("tbody",ee,[a(y).loading?(u(),c("tr",te,[...t[8]||(t[8]=[e("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-500"},[e("div",{class:"flex flex-col items-center animate-pulse"},[e("div",{class:"h-4 w-32 bg-gray-200 rounded mb-2"}),e("div",{class:"h-3 w-48 bg-gray-100 rounded"})])],-1)])])):b.value.length===0?(u(),c("tr",se,[e("td",ae,[n(a(i),{name:"users",class:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t[9]||(t[9]=e("p",{class:"font-medium text-gray-900"},"No contacts found",-1)),t[10]||(t[10]=e("p",{class:"text-sm mt-1"},"Get started by adding a new contact from CRM.",-1))])])):(u(!0),c(F,{key:2},O(b.value,r=>(u(),c("tr",{key:r.name,onClick:$=>C(r),class:"group hover:bg-gray-50/80 transition-colors cursor-pointer"},[e("td",re,[e("div",ne,[e("div",le,l(V(r)),1),e("div",null,[e("div",ie,l(r.first_name)+" "+l(r.last_name),1),e("div",de,[n(a(i),{name:"briefcase",class:"w-3 h-3"}),x(" "+l(r.designation||"No Designation"),1)])])])]),e("td",ce,[e("span",{class:j(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold border",S(r.status)])},l(r.status),3)]),e("td",ue,[e("div",me,[r.email_id?(u(),c("div",xe,[n(a(i),{name:"mail",class:"w-3 h-3 text-gray-400 mr-2"}),x(" "+l(r.email_id),1)])):_("",!0),h(r)?(u(),c("div",pe,[n(a(i),{name:"phone",class:"w-3 h-3 text-gray-400 mr-2"}),x(" "+l(h(r)),1)])):_("",!0),!r.email_id&&!h(r)?(u(),c("span",ge,"No info")):_("",!0)])]),e("td",fe,l(r.company_name||"-"),1),e("td",ye,[n(a(i),{name:"chevron-right",class:"w-4 h-4 text-gray-300 inline-block group-hover:text-primary-500 transition-colors"})])],8,oe))),128))])])]),e("div",he,[t[12]||(t[12]=e("span",{class:"text-xs text-gray-500"},"Showing top 50 contacts",-1)),e("div",ve,[e("button",be,[n(a(i),{name:"chevron-left",class:"w-4 h-4"})]),e("button",_e,[n(a(i),{name:"chevron-right",class:"w-4 h-4"})])])])]),n(a(G),{modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=r=>f.value=r),options:{size:"xl"}},{"body-title":p(()=>[e("div",we,[n(a(i),{name:"user",class:"w-5 h-5 text-primary-500"}),t[13]||(t[13]=x(" Contact Profile ",-1))])]),"body-content":p(()=>[s.value?(u(),c("div",Ce,[e("div",ke,[t[14]||(t[14]=e("div",{class:"absolute top-0 right-0 w-32 h-32 bg-primary-50 rounded-bl-full opacity-50 pointer-events-none"},null,-1)),e("div",Ne,l(V(s.value)),1),e("div",je,[e("h2",De,l(s.value.salutation?s.value.salutation+" ":"")+" "+l(s.value.first_name)+" "+l(s.value.last_name),1),e("div",Ie,l(s.value.designation||"No Designation"),1),e("div",Se,[e("span",{class:j(["inline-flex items-center px-3 py-1 rounded-full text-xs font-bold border",S(s.value.status)])},l(s.value.status),3),s.value.company_name?(u(),c("span",Ve,[n(a(i),{name:"briefcase",class:"w-3 h-3 mr-1.5"}),x(" "+l(s.value.company_name),1)])):_("",!0)])])]),e("div",$e,[e("div",Re,[t[18]||(t[18]=e("h3",{class:"text-sm font-bold text-gray-900 uppercase tracking-wider mb-3"},"Contact Information",-1)),e("div",Te,[e("div",Ae,[e("div",Le,[n(a(i),{name:"mail",class:"w-4 h-4"})]),e("div",Me,[t[15]||(t[15]=e("div",{class:"text-xs text-gray-500 font-medium uppercase"},"Email Address",-1)),e("div",{class:"text-sm font-semibold text-gray-900 truncate",title:s.value.email_id},l(s.value.email_id||"Not provided"),9,Pe)])]),e("div",Be,[e("div",ze,[n(a(i),{name:"phone",class:"w-4 h-4"})]),e("div",Ee,[t[16]||(t[16]=e("div",{class:"text-xs text-gray-500 font-medium uppercase"},"Phone Number",-1)),e("div",{class:"text-sm font-semibold text-gray-900",title:h(s.value)},l(h(s.value)||"Not provided"),9,Fe)])])]),t[19]||(t[19]=e("h3",{class:"text-sm font-bold text-gray-900 uppercase tracking-wider mt-6 mb-3"},"Other Details",-1)),e("div",Oe,[e("div",Ue,[e("div",Ge,[n(a(i),{name:"user",class:"w-4 h-4"})]),e("div",qe,[t[17]||(t[17]=e("div",{class:"text-xs text-gray-500 font-medium uppercase"},"Gender",-1)),e("div",Je,l(s.value.gender||"Not specified"),1)])])])]),e("div",Qe,[t[26]||(t[26]=e("h3",{class:"text-sm font-bold text-gray-900 uppercase tracking-wider mb-3"},"Actions",-1)),e("div",Ye,[h(s.value)?(u(),c("div",He,[e("div",Ke,[n(a(i),{name:"phone-call",class:"w-8 h-8 text-primary-600"})]),t[23]||(t[23]=e("h4",{class:"text-lg font-bold text-gray-900"},"Ready to connect?",-1)),e("p",We,[t[20]||(t[20]=x(" Initiate an AI-powered call with ",-1)),e("span",Xe,l(s.value.first_name),1),t[21]||(t[21]=x(" immediately. ",-1))]),n(a(N),{variant:"solid",size:"xl",class:"w-full !rounded-xl !bg-primary-600 hover:!bg-primary-700 !text-white shadow-xl shadow-primary-500/30 transform hover:-translate-y-1 transition-all",loading:w.value,onClick:A},{default:p(()=>[...t[22]||(t[22]=[x(" Start AI Call Now ",-1)])]),_:1},8,["loading"])])):(u(),c("div",Ze,[e("div",et,[n(a(i),{name:"phone-off",class:"w-8 h-8 text-gray-400"})]),t[24]||(t[24]=e("h4",{class:"text-lg font-bold text-gray-900"},"No Phone Number",-1)),t[25]||(t[25]=e("p",{class:"text-sm text-gray-500 mt-1 max-w-xs mx-auto"}," You cannot start a call without a valid phone number. Please update the contact in CRM. ",-1))]))])])])])):_("",!0)]),actions:p(()=>[e("div",tt,[n(a(N),{variant:"outline",class:"!border-gray-200 hover:!bg-gray-50",onClick:T},{prefix:p(()=>[n(a(i),{name:"external-link",class:"w-4 h-4"})]),default:p(()=>[t[27]||(t[27]=x(" View in CRM ",-1))]),_:1}),n(a(N),{variant:"subtle",onClick:t[1]||(t[1]=r=>f.value=!1)},{default:p(()=>[...t[28]||(t[28]=[x("Close",-1)])]),_:1})])]),_:1},8,["modelValue"]),n(U,{name:"slide-fade"},{default:p(()=>[m.value.show?(u(),c("div",{key:0,class:j(["fixed bottom-6 right-6 z-50 flex items-center gap-4 px-5 py-4 bg-white rounded-xl shadow-2xl border border-gray-100 max-w-md transform transition-all",m.value.type==="success"?"border-l-4 border-l-green-500":"border-l-4 border-l-red-500"])},[e("div",{class:j(["flex items-center justify-center w-10 h-10 rounded-full shrink-0",m.value.type==="success"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},[n(a(i),{name:m.value.type==="success"?"check":"alert-circle",class:"h-5 w-5"},null,8,["name"])],2),e("div",null,[e("h4",st,l(m.value.title),1),e("p",at,l(m.value.message),1)]),e("button",{onClick:t[3]||(t[3]=r=>m.value.show=!1),class:"text-gray-400 hover:text-gray-600 ml-2"},[n(a(i),{name:"x",class:"w-4 h-4"})])],2)):_("",!0)]),_:1})])}}};var lt=M(ot,[["__scopeId","data-v-40065cfa"]]);export{lt as default};
