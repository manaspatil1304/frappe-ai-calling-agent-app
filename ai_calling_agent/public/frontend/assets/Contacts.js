var S=(v,h,t)=>new Promise((y,d)=>{var x=_=>{try{b(t.next(_))}catch(m){d(m)}},F=_=>{try{b(t.throw(_))}catch(m){d(m)}},b=_=>_.done?y(_.value):Promise.resolve(_.value).then(x,F);b((t=t.apply(v,h)).next())});import{E as B,d as C,c as E,e as u,f as e,g as l,w as i,u as n,B as k,F as R,h as $,D as z,T as P,G as M,H as O,o as p,_ as g,t as a,l as c,I as D,i as j,n as A}from"./vendor.js";const f=v=>(M("data-v-e010f9cc"),v=v(),O(),v),L={class:"p-8 max-w-7xl mx-auto relative"},G={class:"flex justify-between items-center mb-6"},U=f(()=>e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Contacts"),e("p",{class:"text-sm text-gray-500 mt-1"},"Synced with Frappe CRM")],-1)),H=c(" Add Contact (CRM) "),J={class:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden"},q={class:"w-full text-left text-sm"},K=f(()=>e("thead",{class:"bg-gray-50 border-b border-gray-200 text-gray-500 font-medium"},[e("tr",null,[e("th",{class:"px-6 py-3"},"Name & Designation"),e("th",{class:"px-6 py-3"},"Status"),e("th",{class:"px-6 py-3"},"Contact Info"),e("th",{class:"px-6 py-3"},"Company")])],-1)),Q={class:"divide-y divide-gray-100"},W={key:0},X=f(()=>e("td",{colspan:"4",class:"p-6 text-center text-gray-500"}," Loading contacts... ",-1)),Y=[X],Z={key:1},ee=f(()=>e("td",{colspan:"4",class:"p-6 text-center text-gray-500"}," No contacts found. ",-1)),te=[ee],se=["onClick"],ae={class:"px-6 py-4"},oe={class:"font-medium text-gray-900 group-hover:text-[#4318FF] transition-colors"},ne={class:"text-xs text-gray-400 mt-0.5"},le={class:"px-6 py-4"},ie={class:"px-6 py-4"},re={class:"text-gray-900"},ce={class:"text-gray-500 mt-0.5"},de={class:"px-6 py-4 text-gray-600"},_e=f(()=>e("h3",{class:"text-xl font-bold"},"Contact Details",-1)),ue={key:0,class:"mt-6 space-y-6"},pe={class:"flex items-start justify-between border-b border-gray-100 pb-6"},he={class:"flex gap-4"},me={class:"h-16 w-16 rounded-full bg-[#4318FF]/10 flex items-center justify-center text-2xl font-bold text-[#4318FF]"},ge={class:"text-2xl font-bold text-gray-900"},fe={class:"text-gray-500"},ve={class:"mt-2"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={class:"space-y-1"},be=f(()=>e("div",{class:"text-xs font-semibold text-gray-500 uppercase"}," Contact Info ",-1)),we={class:"flex items-center gap-2 text-gray-700"},Ce={class:"flex items-center gap-2 text-gray-700"},ke={class:"space-y-1"},Fe=f(()=>e("div",{class:"text-xs font-semibold text-gray-500 uppercase"}," Professional ",-1)),Ne={class:"flex items-center gap-2 text-gray-700"},Ie={class:"flex items-center gap-2 text-gray-700"},Se={class:"bg-gray-50 p-4 rounded-lg flex items-center justify-between mt-4"},De={class:"text-sm text-gray-600"},je={key:0},Te=c(" Ready to call "),Ve={key:1,class:"text-red-500"},Be=c(" Start AI Call "),Ee=c("Close"),Re=c("Open in Desk"),$e={key:0,class:"fixed bottom-6 right-6 z-50 flex items-center gap-3 px-4 py-3 bg-white rounded-lg shadow-lg border border-gray-100 max-w-sm"},ze={class:"text-sm font-semibold text-gray-900"},Pe={class:"text-xs text-gray-500"},Me={setup(v){const h=C(!1),t=C(null),y=C(!1),d=C({show:!1,title:"",message:"",type:"success"}),x=E({url:"frappe.client.get_list",params:{doctype:"Contact",fields:["name","first_name","last_name","salutation","email_id","mobile_no","phone","status","designation","company_name","gender"],order_by:"creation desc",limit:50},auto:!0});function F(){window.open("/app/contact/new","_blank")}function b(o){t.value=o,h.value=!0}function _(){t.value&&window.open(`/app/contact/${t.value.name}`,"_blank")}function m(o,r,s="success"){d.value={show:!0,title:o,message:r,type:s},setTimeout(()=>{d.value.show=!1},4e3)}function T(){return S(this,null,function*(){const o=t.value,r=w(o);if(!r){m("Missing Info","No phone number found for this contact.","error");return}y.value=!0;try{const s=yield fetch("/api/method/ai_calling_agent.api.start_ai_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone_number:`${r}`,contact_docname:o.name})}),I=yield s.json();if(s.ok)m("Call Initiated","Connecting agent...","success"),h.value=!1;else throw new Error(I.message||"Server Error")}catch(s){console.error(s),m("Error",`Failed to start call: ${s.message}`,"error")}finally{y.value=!1}})}function w(o){return o.mobile_no||o.phone||null}function N(o){return o==="Open"?"green":o==="Replied"?"blue":o==="Passive"?"orange":"gray"}function V(o){const r=o.first_name?o.first_name[0]:"",s=o.last_name?o.last_name[0]:"";return(r+s).toUpperCase()}return(o,r)=>(p(),u("div",L,[e("div",G,[U,l(n(k),{variant:"solid",size:"md",class:"!bg-[#4318FF] hover:!bg-[#3311CC] !text-white border-transparent",onClick:F},{prefix:i(()=>[l(n(g),{name:"plus",class:"h-4 w-4"})]),default:i(()=>[H]),_:1})]),e("div",J,[e("table",q,[K,e("tbody",Q,[n(x).loading?(p(),u("tr",W,Y)):!n(x).data||n(x).data.length===0?(p(),u("tr",Z,te)):(p(!0),u(R,{key:2},$(n(x).data,s=>(p(),u("tr",{key:s.name,onClick:I=>b(s),class:"hover:bg-gray-50 transition-colors cursor-pointer group"},[e("td",ae,[e("div",oe,a(s.first_name)+" "+a(s.last_name),1),e("div",ne,a(s.designation||"No Designation"),1)]),e("td",le,[l(n(D),{theme:N(s.status)},{default:i(()=>[c(a(s.status),1)]),_:2},1032,["theme"])]),e("td",ie,[e("div",re,a(s.email_id||"-"),1),e("div",ce,a(s.mobile_no||s.phone||"-"),1)]),e("td",de,a(s.company_name||"-"),1)],8,se))),128))])])]),l(n(z),{modelValue:h.value,"onUpdate:modelValue":r[1]||(r[1]=s=>h.value=s),options:{size:"xl"}},{"body-title":i(()=>[_e]),"body-content":i(()=>[t.value?(p(),u("div",ue,[e("div",pe,[e("div",he,[e("div",me,a(V(t.value)),1),e("div",null,[e("h2",ge,a(t.value.salutation?t.value.salutation+" ":"")+" "+a(t.value.first_name)+" "+a(t.value.last_name),1),e("div",fe,a(t.value.designation),1),e("div",ve,[l(n(D),{theme:N(t.value.status),size:"lg"},{default:i(()=>[c(a(t.value.status),1)]),_:1},8,["theme"])])])])]),e("div",xe,[e("div",ye,[be,e("div",we,[l(n(g),{name:"mail",class:"h-4 w-4 text-[#4318FF]"}),c(" "+a(t.value.email_id||"No Email"),1)]),e("div",Ce,[l(n(g),{name:"phone",class:"h-4 w-4 text-[#4318FF]"}),c(" "+a(t.value.mobile_no||t.value.phone||"No Phone"),1)])]),e("div",ke,[Fe,e("div",Ne,[l(n(g),{name:"briefcase",class:"h-4 w-4 text-[#4318FF]"}),c(" "+a(t.value.company_name||"No Company"),1)]),e("div",Ie,[l(n(g),{name:"user",class:"h-4 w-4 text-[#4318FF]"}),c(" "+a(t.value.gender||"Gender Not Specified"),1)])])]),e("div",Se,[e("div",De,[w(t.value)?(p(),u("span",je,[Te,e("strong",null,a(w(t.value)),1)])):(p(),u("span",Ve,"No phone number available."))]),l(n(k),{variant:"solid",class:"!bg-[#4318FF] hover:!bg-[#3311CC] !text-white border-transparent",loading:y.value,disabled:!w(t.value),onClick:T},{prefix:i(()=>[l(n(g),{name:"phone-call",class:"h-4 w-4"})]),default:i(()=>[Be]),_:1},8,["loading","disabled"])])])):j("",!0)]),actions:i(()=>[l(n(k),{variant:"subtle",onClick:r[0]||(r[0]=s=>h.value=!1)},{default:i(()=>[Ee]),_:1}),l(n(k),{variant:"outline",onClick:_},{default:i(()=>[Re]),_:1})]),_:1},8,["modelValue"]),l(P,{name:"fade"},{default:i(()=>[d.value.show?(p(),u("div",$e,[e("div",{class:A(["flex items-center justify-center w-8 h-8 rounded-full",d.value.type==="success"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},[l(n(g),{name:d.value.type==="success"?"check":"alert-circle",class:"h-5 w-5"},null,8,["name"])],2),e("div",null,[e("h4",ze,a(d.value.title),1),e("p",Pe,a(d.value.message),1)])])):j("",!0)]),_:1})]))}};var Le=B(Me,[["__scopeId","data-v-e010f9cc"]]);export{Le as default};
